Here I haven't imposed the smoothness constraints